<!DOCTYPE html>
<html lang="en">
    <body>
    <h1>Top 100 Players</h1>
    <button id="clearBtn">Clear All Scores</button>

    <script>
    document.getElementById('clearBtn').addEventListener('click', () => {
        fetch('/delete-all', { method: 'POST' })
            .then(res => res.json())
            .then(data => {
                alert(data.message || data.error);
                location.reload();
            })
            .catch(err => alert('Error: ' + err));
    });
    </script>

    <table id="leaderboard-table">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Player</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody>
            {% for score in scores %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ score.player_id }}</td>
                <td>{{ score.score }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
    function fetchLeaderboard() {
        fetch('/')
            .then(response => response.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const newTable = doc.querySelector('#leaderboard-table');
                if (newTable) {
                    document.querySelector('#leaderboard-table').innerHTML = newTable.innerHTML;
                }
            });
    }
    setInterval(fetchLeaderboard, 500); // Every .5 seconds
    </script>
</body>
</html>